<html>
  <head>
    <title>Meander Maker</title>
    <!--both brython.js and brython_stdlib.js files live in the static/ dir-->
    <script type="text/javascript" src="brython.js"></script>
    <script type="text/javascript" src="brython_stdlib.js"></script>
  </head>
  <!--adding custom style tag called yellow-->
  <style>
      .meander_map {
          width: 100%;
          height: 100%;
      }
    div.yellow {
      background-color: yellow;
    }
  </style>
  <body id="page-top" onload="brython(1)">
    <div class="row">
        <div class="column">
      <h1>User Input</h1>
    <script type="text/python3">
      from browser import document, ajax
      import json
      import warnings
      def show_results(response):
          if response.status==200:
              data = json.loads(response.text)
              places = [f"{place['name']} ({place['rating']})"
                        for place in data['best_cluster']]
              document["places"].html = "<br />".join(places)
              document["gmap"].html = data['iframe']
          else:
              warnings.warn(response.text)
      def get_output(ev):
          req = ajax.ajax()
          req.bind("complete", show_results)
          req.open("POST", "/output", True)
          req.set_header("content-type","application/json")
          data = json.dumps({"loc": document["user_input_loc"].value,
                             "topic": document["user_input_topic"].value,
                             "mode": document["user_input_mode"].value,
                             "patience": document["patience"].value,
                             "p_size": document["p_size"].value,
                             "p_rating": document["p_rating"].value,
                             "p_min_dist": document["p_min_dist"].value,
                             "p_internal_dist": document["p_internal_dist"].value,
                             })
          req.send(data)
      document["click_button"].bind("click", get_output)
    </script>
    <label for="user_input_loc">Starting Location (specific is better than general)</label>
      <textarea id="user_input_loc">Hôtel Ampère Paris</textarea>
    <br />
      <label for="user_input_topic">Topic (Anything Google Maps can return results for)</label>
      <textarea id="user_input_topic">wine tasting</textarea>
    <br />
      <label for="user_input_mode">Mode of Transport</label>
      <select id="user_input_mode">
          <option value="walking">Walking</option>
          <option value="driving">Driving</option>
          <option value="bicycling">Bicycle</option>
          <option value="transit">Public Transit</option>
      </select>
    <br />
      <label for="patience">Max Search Results (page loads in groups of 20, adds 2 seconds of wait time)</label>
        <input type="range" id="patience" name="seconds" min="1" max="3">
    <dl>
      <dt>Advanced Tuning</dt>
      <dd>
        <br />
      <label for="p_size">Variety</label>
        <input type="range" id="p_size" name="seconds" min="1" max="8">
    <br />
      <label for="p_rating">Ratings</label>
        <input type="range" id="p_rating" name="seconds" min="1" max="8">
    <br />
      <label for="p_min_dist">Short Distance to First Stop</label>
        <input type="range" id="p_min_dist" name="seconds" min="1" max="8" >
    <br />
      <label for="p_internal_dist">Internal Distance within Cluster</label>
        <input type="range" id="p_internal_dist" name="seconds" min="1" max="8">
    
  </dd>
  </dl>
  <br />
    <button id="click_button">Compute! (may take several seconds)</button>
    <br />
    <h1>User Output</h1>
    <!--try replacing yellow with div to remove the yellow styling-->
    <div class="yellow" id="places"></div>
            </div>
        <!-- <div class="column"> -->
    <div class="column" id="gmap"></div>
            <!-- </div> -->
  </div>
    </body>
</html>
